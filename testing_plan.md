# 惯蛋记分器测试计划

## 1. 测试目标

基于需求文档，制定全面的测试计划，确保惯蛋记分器应用的功能完整性、用户体验和代码质量。

## 2. 测试范围

### 2.1 功能测试
- 惯蛋游戏核心逻辑
- 用户界面交互
- 数据持久化
- 日志系统

### 2.2 平台测试
- iPhone 10及以后版本
- iPad
- 横屏模式适配
- 深色模式


### 2.3 性能测试
- 应用启动性能
- 界面响应速度
- 内存使用

## 3. 测试分类

### 3.1 单元测试 (Unit Tests)

#### 3.1.1 游戏逻辑模型测试
- **级别升级规则测试**
  - 测试2~K级别的正常升级
  - 测试升级到A1的限制规则
  - 测试A1~A3级别的特殊规则

- **庄家系统测试**
  - 测试庄家轮换逻辑
  - 测试庄家获胜继续当庄规则
  - 测试庄家失败后交换庄家

- **贡牌结果测试**
  - 双贡：升3级逻辑
  - 单贡：升2级逻辑
  - 自贡：升1级逻辑
  - 特殊情况：A级别时的获胜判定

- **游戏结束条件测试**
  - A1~A3级别时对方双贡/单贡的获胜判定
  - A3级别时本方有下游的失败判定
  - 游戏完成状态的正确设置

#### 3.1.2 数据模型测试
- **GameScore模型测试**
  - 游戏数据的序列化/反序列化
  - 轮次记录的正确保存
  - 队伍状态的准确维护

- **TeamStatus模型测试**
  - 队伍信息的初始化
  - 级别变更的状态更新
  - 庄家标识的正确设置

#### 3.1.3 工具类测试
- **OSLogger测试**
  - 日志输出功能
  - 不同日志级别的处理
  - 日志文件保存功能

- **GameManager测试**
  - 游戏数据的加载/保存
  - 游戏列表的管理
  - 数据持久化的正确性

### 3.2 界面测试 (UI Tests)

#### 3.2.1 首页界面测试
- **对局列表功能**
  - 对局信息的正确显示
  - 搜索过滤功能
  - 列表项点击导航
  - 左滑操作（再来一局、删除）

- **导航测试**
  - "来一局"按钮跳转
  - 对局详情页面进入
  - 返回首页功能

#### 3.2.2 新建一局界面测试
- **输入验证**
  - 队员姓名输入
  - 庄家选择（互斥性）
  - 输入完整性验证

- **界面交互**
  - 开局按钮功能
  - 取消按钮返回
  - 表单重置功能

#### 3.2.3 一局界面测试
- **队伍信息显示**
  - 队员姓名显示
  - 当前级别显示
  - 庄家标识显示

- **贡牌操作界面**
  - 点击队伍区域弹出贡牌选择
  - 双贡/单贡/自贡按钮功能
  - 游戏结束时的界面状态

- **轮次记录显示**
  - 轮次历史列表
  - 滚动到最新记录
  - 删除最后一轮功能
  - 左滑删除操作

- **回退前进功能**
  - 回退按钮功能
  - 前进按钮功能
  - 状态一致性验证

#### 3.2.4 响应式设计测试
- **设备适配**
  - iPhone各尺寸适配
  - iPad界面适配
  - 横屏模式布局

- **主题测试**
  - 浅色模式显示
  - 深色模式显示
  - 主题切换过渡

### 3.3 集成测试 (Integration Tests)

#### 3.3.1 数据流测试
- **完整游戏流程**
  - 新建游戏 → 进行多轮 → 完成游戏
  - 数据在各界面间的正确传递
  - 状态变化的同步更新

- **数据持久化集成**
  - 游戏数据的保存和加载
  - 应用重启后数据完整性
  - 异常情况下的数据恢复

#### 3.3.2 界面导航集成
- **导航流程完整性**
  - 首页 → 新建游戏 → 游戏进行 → 返回首页
  - 深层页面的返回路径
  - 意外中断后的状态恢复

### 3.4 系统测试 (System Tests)

#### 3.4.1 边界条件测试
- **极限数据测试**
  - 大量游戏记录的处理
  - 长时间游戏的性能
  - 内存使用的合理性

- **异常情况处理**
  - 网络中断恢复
  - 内存不足处理
  - 系统权限变更

#### 3.4.2 兼容性测试
- **iOS版本兼容**
  - 不同iOS版本的功能验证
  - 系统API的兼容性

- **设备兼容**
  - 不同屏幕尺寸适配
  - 性能在不同设备上的表现

## 4. 测试数据准备

### 4.1 基础测试数据
- 标准4人组合数据
- 不同级别的游戏状态
- 各种贡牌结果场景

### 4.2 边界测试数据
- 最大级别A3的游戏场景
- 连续多轮相同结果
- 极限轮次数量

### 4.3 异常测试数据
- 空姓名输入
- 特殊字符姓名
- 极长姓名字符串

## 5. 测试工具和框架

### 5.1 单元测试
- **Swift Testing Framework**: 核心逻辑测试
- **XCTest**: 兼容性测试支持

### 5.2 UI测试
- **XCUITest**: 界面自动化测试
- **UI Recording**: 交互流程录制

### 5.3 性能测试
- **XCTest Performance**: 启动和响应时间测试
- **Instruments**: 内存和CPU使用分析

## 6. 测试环境

### 6.1 开发环境
- Xcode 最新稳定版
- iOS Simulator 多版本
- 真机测试设备

### 6.2 测试设备矩阵
- iPhone 12/13/14/15 (不同尺寸)
- iPad Pro/Air (横屏测试)
- iOS 15.0+ 各版本

## 7. 测试执行策略

### 7.1 测试阶段
1. **开发阶段**: 单元测试持续执行
2. **功能完成**: 集成测试和UI测试
3. **发布前**: 完整系统测试

### 7.2 自动化策略
- 单元测试100%自动化
- 核心UI流程自动化
- 回归测试全自动化

### 7.3 手工测试重点
- 用户体验细节
- 复杂交互场景
- 边界情况验证

## 8. 质量标准

### 8.1 代码覆盖率
- 单元测试覆盖率 ≥ 80%
- 核心逻辑覆盖率 ≥ 95%

### 8.2 缺陷标准
- 关键功能零缺陷
- 一般功能缺陷密度 < 1%

### 8.3 性能标准
- 应用启动时间 < 3秒
- 界面响应时间 < 500ms
- 内存使用 < 100MB

## 9. 风险评估

### 9.1 技术风险
- 复杂游戏规则的实现正确性
- 数据持久化的可靠性
- 多设备适配的一致性

### 9.2 测试风险
- 测试数据的完整性
- 自动化测试的维护成本
- 真机测试设备的可用性

## 10. 测试交付物

### 10.1 测试代码
- 单元测试套件
- UI测试套件
- 性能测试套件

### 10.2 测试文档
- 测试用例文档
- 测试执行报告
- 缺陷跟踪记录

### 10.3 质量报告
- 代码覆盖率报告
- 性能测试报告
- 最终质量评估报告

## 11. 测试时间表

### 11.1 阶段规划
- **第1周**: 单元测试开发和执行
- **第2周**: UI测试开发和基础功能验证
- **第3周**: 集成测试和系统测试
- **第4周**: 性能测试和最终验证

### 11.2 里程碑
- 核心逻辑测试完成
- 基础UI功能验证完成
- 完整功能测试完成
- 发布质量验证完成

这个测试计划将为惯蛋记分器应用提供全面的质量保障，确保应用的功能完整性、用户体验和代码质量达到预期标准。